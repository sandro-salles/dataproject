CREATE TABLE contact_carrier_test AS
  TABLE contact_carrier;


  INSERT INTO contact_carrier_test (
    name, 
    slug, 
    created_ad, 
    updated_at) 
VALUES (
    'sandro', 
    ‘sandro’, 
    now(), 
    now()
    )
ON CONFLICT DO UPDATE SET description=excluded.name;



INSERT INTO 
	contact_carrier
		(name, slug, created_at) 
	VALUES 
		('sandro 4-', 'sandro4', now()),
		('sandro 5-', 'sandro8', now())
ON CONFLICT (slug) 
	DO UPDATE 
		SET name=excluded.name, updated_at=now()
RETURNING *, CASE WHEN updated_at IS NULL THEN 'created' ELSE 'updated' END;



INSERT INTO 
	contact_carrier
		(name, slug, created_at, updated_at) 
	VALUES 
		('sandro 4-', 'sandro', now(), now()),
		('sandro 5-', 'sandro2', now(), now())
ON CONFLICT (slug) 
	DO NOTHING 
RETURNING *;


select pg_backend_pid();


from person.models import Person
p1 = Person(name='Sandro Salles', document='26610217874')
p2 = Person(name='Sandro Sales', document='26610215874')
pessoas = Person.objects.bulk_upsert([p1,p2], unique_field='document', update_fields=['name','updated_at'])

ret.extend(self._upsert(batch, fields=fields, using=self.db, unique_field=unique_field, update_fields=update_fields))
